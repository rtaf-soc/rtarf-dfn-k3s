%YAML 1.1
---

vars:
  address-groups:
    HOME_NET: "[10.0.0.0/8,192.168.0.0/16]"
    EXTERNAL_NET: "!$HOME_NET"

  port-groups:
    HTTP_PORTS: "80"
    HTTPS_PORTS: "443"

# ======================
# Capture
# ======================
af-packet:
  - interface: eth0
    cluster-type: cluster_flow
    cluster-id: 99
    defrag: yes
    use-mmap: yes
    tpacket-v3: yes

# ======================
# Rules
# ======================
default-rule-path: /var/lib/suricata/rules

rule-files:
  - suricata.rules
  - local.rules

# ======================
# Logging / Outputs
# ======================
outputs:

  # ❌ ปิด fast.log
  - fast:
      enabled: yes
      filename: /suricata-logs/suricata.fast.log

  # ✅ EVE JSON
  - eve-log:
      enabled: yes
      filetype: regular
      filename: /suricata-logs/eve.json

      # ⭐ สำคัญมาก ใช้ correlate Zeek / Arkime
      community-id: true

      types:
        - alert
        - flow

# ======================
# Performance
# ======================
threading:
  set-cpu-affinity: no

stream:
  memcap: 1gb
  checksum-validation: yes

flow:
  memcap: 256mb
  hash-size: 65536
  emergency-recovery: 30

# ======================
# Detection
# ======================
detect:
  profile: medium

# ======================
# Logging level
# ======================
logging:
  default-log-level: notice

# ======================
# App Layer
# ======================
app-layer:
  protocols:
    dns:
      enabled: yes
    http:
      enabled: yes
    tls:
      enabled: yes
